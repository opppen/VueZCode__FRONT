import{y as F,N as A,I as L,q as R,z as M,a8 as j,d as e,a5 as P,a6 as D,ac as J,r as w,a as K,o as i,c as d,w as l,f as $,ak as N,S as C,e as S,aq as U,aU as H,ag as s,an as q,J as Q,am as h,g as W,i as X,aI as Y,h as Z,V as B,aK as ee,j as y,bs as te,k as u,ao as g,R as b,al as E,ae,af as le}from"./index.ea86435d.js";import{V as oe,a as se}from"./VPagination.c0a526a3.js";import{m as ne,f as ie,a as re,b as de,V as ue}from"./VInput.1d6be533.js";import{m as ce,f as _e,a as me}from"./VSelectionControl.acc45ccc.js";import{V as k}from"./VRadio.e979238d.js";import{v as fe}from"./index.3a8c39a5.js";const pe=F({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...ne(),...ce(),trueIcon:{type:A,default:"$radioOn"},falseIcon:{type:A,default:"$radioOff"},type:{type:String,default:"radio"}},setup(r,c){let{attrs:a,slots:_}=c;const m=L(),V=R(()=>r.id||`radio-group-${m}`);return M(()=>{const[v,I]=j(a),[O,n]=ie(r),[o,t]=_e(r),f=_.label?_.label({label:r.label,props:{for:V.value}}):r.label;return e(de,D({class:"v-radio-group"},v,O,{id:V.value}),{..._,default:p=>{let{id:z,isDisabled:G,isReadonly:T}=p;return e(P,null,[f&&e(re,{for:z.value},{default:()=>[f]}),e(me,D(o,{id:z.value,trueIcon:r.trueIcon,falseIcon:r.falseIcon,type:r.type,disabled:G.value,readonly:T.value},I),_)])}})}),{}}}),x=r=>(ae("data-v-a460f2be"),r=r(),le(),r),ge={id:"orders"},he=x(()=>s("h1",{class:"text-center"},"\u7BA1\u7406\u8005\u8A02\u55AE\u7BA1\u7406",-1)),Ve=x(()=>s("thead",null,[s("tr",null,[s("th",null,"\u8A02\u55AE\u7DE8\u865F"),s("th",null,"\u8A02\u8CFC\u6703\u54E1"),s("th",null,"\u8A02\u8CFC\u65E5\u671F"),s("th",null,"\u8A02\u55AE\u91D1\u984D"),s("th",null,"\u5546\u54C1\u540D\u7A31"),s("th",null,"\u8655\u7406\u72C0\u614B"),s("th",null,"\u7BA1\u7406")])],-1)),ve={key:0},ye={key:1},be={key:2},ke=u("mdi-comment-outline"),xe=u("\u8A02\u55AE\u78BA\u8A8D\u4E2D "),Ie={key:3},we=u("mdi-comment-processing-outline"),Ce=u("\u5546\u54C1\u51FA\u8CA8\u4E2D "),Se={key:4},Re=u("mdi-comment-check-outline"),Pe=u("\u8A02\u55AE\u5DF2\u5B8C\u6210 "),Oe={key:5},ze=u("mdi-comment-remove-outline"),Ae=u("\u8A02\u55AE\u5DF2\u53D6\u6D88 "),De=u("\u7DE8\u8F2F"),$e=u("\u7DE8\u8F2F"),Ne={key:0},Ue=x(()=>s("td",{colspan:"5"},[s("h3",{class:"text-center"},"\u6C92\u6709\u8A02\u55AE")],-1)),qe=[Ue],Be=x(()=>s("div",{class:"text-h5 font-weight-bold text-center py-5"},"\u7DE8\u8F2F\u8A02\u55AE",-1)),Ee=u("\u53D6\u6D88"),Ge=u("\u78BA\u8A8D\u9001\u51FA"),Te={__name:"OrdersView",setup(r){const c=w([]),a=w({_id:"",email:"",tone:"",category:"\u8A02\u55AE\u78BA\u8A8D\u4E2D",dialog:!1,valid:!1,submitting:!1,idx:-1});w({required(n){return!!n||"\u5FC5\u586B"},email(n){return fe.exports.isEmail(n)||"\u4FE1\u7BB1\u683C\u5F0F\u932F\u8AA4"}});const _=5,m=K(1),V=R(()=>c.slice(m.value*_-_,m.value*_));R(()=>c.slice(0).reverse());const v=(n,o)=>{a._id=c[o]._id,a.tone=c[o].tone,a.idx=o,a.dialog=!0,a.valid=!1,a.submitting=!1},I=async()=>{a.submitting=!0;try{const{data:n}=await N.patch("/orders/"+a._id,a);c[a.idx].tone=n.result.tone,C.fire({title:"success //\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),a.dialog=!1}catch(n){C.fire({title:"ERROR //\u5931\u6557",text:n.isAxiosError?n.response.data.message:n.message})}a.submitting=!1};return(async()=>{try{const{data:n}=await N.get("/orders/all");c.push(...n.result.map(o=>(o.totalPrice=o.products.reduce((t,f)=>t+f.product.price*f.quantity,0),o)))}catch(n){console.log(n),C.fire({title:"ERROR //\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(n,o)=>(i(),d("div",ge,[e($,null,{default:l(()=>[e(S,{cols:"12"},{default:l(()=>[he]),_:1}),e(U),e(S,{cols:"12"},{default:l(()=>[e(H,null,{default:l(()=>[Ve,s("tbody",null,[(i(!0),d(P,null,q(Q(V),(t,f)=>(i(),d("tr",{key:t._id},[s("td",null,g(t._id),1),t.user===null?(i(),d("td",ve,"\u5E33\u865F\u5DF2\u7D93\u522A\u9664")):(i(),d("td",ye,g(t.user.email),1)),s("td",null,g(new Date(t.date).toLocaleDateString()),1),s("td",null,g(t.totalPrice),1),s("td",null,[s("ul",null,[(i(!0),d(P,null,q(t.products,p=>(i(),d("li",{key:p._id},g(p.product.name)+" x "+g(p.quantity),1))),128))])]),t.tone===0?(i(),d("td",be,[e(b,{size:"x-large",start:"",color:"red"},{default:l(()=>[ke]),_:1}),xe])):h("",!0),t.tone===1?(i(),d("td",Ie,[e(b,{size:"x-large",start:"",color:"yellow"},{default:l(()=>[we]),_:1}),Ce])):h("",!0),t.tone===2?(i(),d("td",Se,[e(b,{size:"x-large",start:"",color:"green"},{default:l(()=>[Re]),_:1}),Pe])):h("",!0),t.tone===3?(i(),d("td",Oe,[e(b,{size:"x-large",start:"",color:"blue"},{default:l(()=>[ze]),_:1}),Ae])):h("",!0),s("td",null,[m.value===1?(i(),E(y,{key:0,onClick:p=>v(t._id,f),variant:"outlined",plain:"",size:"x-small",rounded:"lg"},{default:l(()=>[De]),_:2},1032,["onClick"])):(i(),E(y,{key:1,onClick:p=>v(n.user._id,f+(m.value-1)*_),variant:"outlined",plain:"",size:"x-small",rounded:"lg"},{default:l(()=>[$e]),_:2},1032,["onClick"]))])]))),128)),c.length===0?(i(),d("tr",Ne,qe)):h("",!0)])]),_:1})]),_:1})]),_:1}),e(oe,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=t=>m.value=t),length:Math.ceil(c.length/_),rounded:"circle",class:"ma-5"},null,8,["modelValue","length"]),e(se,{modelValue:a.dialog,"onUpdate:modelValue":o[4]||(o[4]=t=>a.dialog=t)},{default:l(()=>[e(W,{rounded:"xl",width:"300"},{default:l(()=>[e(ue,{modelValue:a.valid,"onUpdate:modelValue":o[3]||(o[3]=t=>a.valid=t),onSubmit:X(I,["prevent"])},{default:l(()=>[e(Y,null,{default:l(()=>[Be,e(U)]),_:1}),e(Z,null,{default:l(()=>[e(B,null,{default:l(()=>[e($,null,{default:l(()=>[e(S,{cols:"12"},{default:l(()=>[e(pe,{modelValue:a.tone,"onUpdate:modelValue":o[1]||(o[1]=t=>a.tone=t),mandatory:""},{default:l(()=>[e(k,{label:"\u8A02\u55AE\u78BA\u8A8D\u4E2D",color:"red",value:"0"}),e(k,{label:"\u5546\u54C1\u51FA\u8CA8\u4E2D",color:"yellow",value:"1"}),e(k,{label:"\u8A02\u55AE\u5DF2\u5B8C\u6210",color:"green",value:"2"}),e(k,{label:"\u8A02\u55AE\u5DF2\u53D6\u6D88",color:"blue",value:"3"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(B,{class:"d-flex mt-n16"},{default:l(()=>[e(y,{onClick:o[2]||(o[2]=t=>a.dialog=!1),color:"red",variant:"tonal",disadled:a.submitting},{default:l(()=>[Ee]),_:1},8,["disadled"]),e(te),e(y,{type:"submit",variant:"tonal",loading:a.submitting,color:"green"},{default:l(()=>[Ge]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1},8,["modelValue"])]))}};var He=J(Te,[["__scopeId","data-v-a460f2be"]]);export{He as default};
